<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MADNI JEWELLERS | Gujrat Luxury</title>
    
    <!-- TAILWIND CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- GSAP ANIMATION (The Engine) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    
    <!-- THREE.JS (The Virtual World) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/PointerLockControls.js"></script>

    <!-- ICONS -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <!-- FONTS -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;800&family=Montserrat:wght@200;300;400;500;600&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: {
                            100: '#FFF9E5',
                            300: '#EAD185',
                            400: '#D4AF37', // The Rolex Gold Standard
                            500: '#B59224',
                            900: '#42360E',
                        },
                        rolexGreen: '#006039',
                        deepBlack: '#020202',
                        glass: 'rgba(255, 255, 255, 0.05)'
                    },
                    fontFamily: {
                        serif: ['Cinzel', 'serif'],
                        sans: ['Montserrat', 'sans-serif']
                    }
                }
            }
        }
    </script>

    <style>
        body {
            margin: 0;
            background-color: #020202;
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            /* Fallback if video fails */
            background-image: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
        }

        /* --- VIDEO SYSTEM --- */
        #video-layer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -10;
            overflow: hidden;
        }

        #bg-video {
            width: 100%; height: 100%;
            object-fit: cover;
            /* Start hidden, fade in via JS for smoothness */
            opacity: 0; 
            transition: opacity 1.5s ease-in-out;
        }

        /* Dark overlay to ensure text is readable over video */
        .cinematic-overlay {
            position: absolute; inset: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.8) 100%);
            z-index: -5;
        }

        /* --- UI GLASSMORPHISM --- */
        .glass-nav {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(212, 175, 55, 0.1);
        }

        .glass-card {
            background: rgba(15, 15, 15, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.4s cubic-bezier(0.19, 1, 0.22, 1);
        }
        .glass-card:hover {
            border-color: #D4AF37;
            transform: translateY(-5px);
            box-shadow: 0 15px 40px -10px rgba(0,0,0,0.8);
        }

        /* --- ANIMATIONS --- */
        /* Text Reveal Effect */
        .reveal-text {
            clip-path: polygon(0 0, 100% 0, 100% 100%, 0% 100%);
        }
        
        /* Chatbot Slide */
        #chatbot {
            transform: translateY(120%);
            transition: transform 0.5s cubic-bezier(0.19, 1, 0.22, 1);
        }
        #chatbot.active { transform: translateY(0); }
    </style>
</head>
<body class="antialiased">

    <!-- 1. VIDEO BACKGROUND SYSTEM -->
    <div id="video-layer">
        <div class="cinematic-overlay"></div>
        <!-- 
             USER INSTRUCTION:
             To use your own video, change src="" to your local file (e.g., src="videos/intro.mp4").
             The 'onerror' ens/Public /videos /luxury.mp4ures the site still works if the video is missing.
        -->
        <video id="bg-video" autoplay loop muted playsinline poster="">
            <source src="/videos /luxury.mp4" type="video/mp4">
        </video>
    </div>

    <!-- 2. PARTICLES LAYER (Subtle Gold Dust) -->
    <div id="particles-container" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></div>

    <!-- 3. MAIN UI CONTAINER -->
    <div id="ui-container" class="relative z-10 min-h-screen flex flex-col justify-between">
        
        <!-- NAVBAR (Initially Hidden) -->
        <nav class="fixed top-0 w-full z-50 glass-nav px-6 md:px-12 py-5 flex justify-between items-center opacity-0" id="navbar">
            <div class="flex items-center gap-3 cursor-pointer group" onclick="router('home')">
                <i class="ph-fill ph-crown text-2xl text-gold-400 group-hover:rotate-12 transition-transform"></i>
                <div class="leading-none">
                    <h1 class="text-lg font-serif font-bold tracking-widest text-white">MADNI</h1>
                    <p class="text-[9px] text-gold-400 tracking-[0.4em] uppercase mt-1">Jewellers</p>
                </div>
            </div>
            
            <div class="hidden md:flex gap-12 text-[10px] font-bold tracking-[0.2em] uppercase text-gray-300">
                <a onclick="router('home')" class="hover:text-gold-400 cursor-pointer transition relative group">Home<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all group-hover:w-full"></span></a>
                <a onclick="router('collections')" class="hover:text-gold-400 cursor-pointer transition relative group">Collections<span class="absolute -bottom-2 left-0 w-0 h-[1px] bg-gold-400 transition-all group-hover:w-full"></span></a>
                <a onclick="router('virtual')" class="text-gold-400 hover:text-white cursor-pointer transition flex items-center gap-2"><i class="ph-bold ph-cube"></i> Virtual Vault</a>
            </div>

            <div class="flex items-center gap-6">
                <button onclick="toggleChat()" class="text-white hover:text-gold-400 transition"><i class="ph ph-chat-centered-text text-xl"></i></button>
                <button onclick="router('cart')" class="text-white hover:text-gold-400 transition relative">
                    <i class="ph ph-shopping-bag text-xl"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-gold-400 text-black text-[9px] font-bold w-4 h-4 rounded-full flex items-center justify-center">0</span>
                </button>
            </div>
        </nav>

        <!-- DYNAMIC CONTENT AREA -->
        <main id="app" class="flex-grow pt-24 px-4 md:px-12">
            <!-- Views (Home, Collections, etc.) will be injected here -->
        </main>

        <!-- FOOTER / WHATSAPP -->
        <div class="fixed bottom-8 left-8 z-40">
            <a href="https://wa.me/923006262886" target="_blank" class="bg-rolexGreen/90 backdrop-blur-md text-white px-6 py-3 rounded-full flex items-center gap-3 shadow-[0_0_30px_rgba(0,96,57,0.4)] hover:scale-105 transition border border-white/10 group overflow-hidden">
                <div class="absolute inset-0 bg-white/20 translate-x-[-100%] group-hover:translate-x-[100%] transition duration-700 ease-in-out"></div>
                <i class="ph-fill ph-whatsapp-logo text-2xl"></i>
                <div>
                    <p class="text-[9px] uppercase opacity-80 leading-none tracking-wider">Book Appointment</p>
                    <p class="font-bold leading-none text-sm mt-0.5">0300 6262 886</p>
                </div>
            </a>
        </div>

        <!-- CHATBOT INTERFACE -->
        <div id="chatbot" class="fixed bottom-8 right-8 w-80 h-[450px] glass-card rounded-2xl flex flex-col overflow-hidden z-50">
            <div class="bg-gold-900/50 p-4 flex justify-between items-center border-b border-gold-400/20">
                <div class="flex items-center gap-2 text-gold-100">
                    <span class="relative flex h-2 w-2">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span>
                    </span>
                    <span class="font-serif text-xs font-bold tracking-wide">Madni Concierge</span>
                </div>
                <button onclick="toggleChat()" class="text-white/60 hover:text-white"><i class="ph-bold ph-x"></i></button>
            </div>
            <div id="chat-history" class="flex-1 p-4 overflow-y-auto space-y-3 text-xs">
                <div class="flex gap-2">
                    <div class="w-6 h-6 rounded-full bg-gold-400 flex items-center justify-center text-black font-bold font-serif">M</div>
                    <div class="bg-white/10 p-2 rounded-lg text-gray-200 max-w-[80%]">
                        Welcome to Madni Jewellers. How may I assist you with our Gold & Diamond collection?
                    </div>
                </div>
            </div>
            <div class="p-3 bg-black/60 border-t border-white/10 flex gap-2">
                <input type="text" id="chat-input" placeholder="Type inquiry..." class="w-full bg-transparent border border-white/20 rounded px-3 py-2 text-white focus:border-gold-400 outline-none text-xs transition-colors">
                <button onclick="sendMessage()" class="text-gold-400 hover:text-white"><i class="ph-fill ph-paper-plane-right text-lg"></i></button>
            </div>
        </div>

    </div>

    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- 1. PRODUCT DATABASE (20 VERIFIED IMAGES) ---
        // Guaranteed high-quality Pexels/Unsplash links. No black boxes.
        const products = [
            // RINGS
            { id: 1, name: "Royal Signet 24K", category: "Rings", price: "PKR 145,000", img: "https://images.pexels.com/photos/1458867/pexels-photo-1458867.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 2, name: "Diamond Solitaire", category: "Rings", price: "PKR 280,000", img: "https://images.pexels.com/photos/265906/pexels-photo-265906.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 3, name: "Gold Band Classic", category: "Rings", price: "PKR 95,000", img: "https://images.pexels.com/photos/6634734/pexels-photo-6634734.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 4, name: "Ruby Heritage", category: "Rings", price: "PKR 165,000", img: "https://images.pexels.com/photos/10976662/pexels-photo-10976662.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 5, name: "Emerald Cut Halo", category: "Rings", price: "PKR 210,000", img: "https://images.pexels.com/photos/10983785/pexels-photo-10983785.jpeg?auto=compress&cs=tinysrgb&w=800" },
            // NECKLACES
            { id: 6, name: "Bridal Choker Set", category: "Necklaces", price: "PKR 850,000", img: "https://images.pexels.com/photos/2894226/pexels-photo-2894226.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 7, name: "Gold Chain Mesh", category: "Necklaces", price: "PKR 220,000", img: "https://images.pexels.com/photos/1253364/pexels-photo-1253364.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 8, name: "Pearl Pendant", category: "Necklaces", price: "PKR 115,000", img: "https://images.pexels.com/photos/10976663/pexels-photo-10976663.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 9, name: "Rani Haar", category: "Necklaces", price: "PKR 650,000", img: "https://images.pexels.com/photos/2849742/pexels-photo-2849742.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 10, name: "Diamond Tennis", category: "Necklaces", price: "PKR 450,000", img: "https://images.pexels.com/photos/5370656/pexels-photo-5370656.jpeg?auto=compress&cs=tinysrgb&w=800" },
            // BANGLES
            { id: 11, name: "Traditional Kangan", category: "Bangles", price: "PKR 350,000", img: "https://images.pexels.com/photos/10082236/pexels-photo-10082236.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 12, name: "Modern Cuff", category: "Bangles", price: "PKR 180,000", img: "https://images.pexels.com/photos/9953629/pexels-photo-9953629.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 13, name: "Thin Gold Set", category: "Bangles", price: "PKR 220,000", img: "https://images.pexels.com/photos/1191531/pexels-photo-1191531.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 14, name: "Diamond Bracelet", category: "Bangles", price: "PKR 195,000", img: "https://images.pexels.com/photos/266621/pexels-photo-266621.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 15, name: "Rose Gold Charm", category: "Bangles", price: "PKR 85,000", img: "https://images.pexels.com/photos/9428790/pexels-photo-9428790.jpeg?auto=compress&cs=tinysrgb&w=800" },
            // WATCHES & EARRINGS
            { id: 16, name: "Luxury Chrono", category: "Watches", price: "PKR 1,200,000", img: "https://images.pexels.com/photos/280250/pexels-photo-280250.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 17, name: "Classic Gold Dial", category: "Watches", price: "PKR 850,000", img: "https://images.pexels.com/photos/190819/pexels-photo-190819.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 18, name: "Jhumka Earrings", category: "Earrings", price: "PKR 125,000", img: "https://images.pexels.com/photos/12395304/pexels-photo-12395304.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 19, name: "Diamond Studs", category: "Earrings", price: "PKR 75,000", img: "https://images.pexels.com/photos/2735970/pexels-photo-2735970.jpeg?auto=compress&cs=tinysrgb&w=800" },
            { id: 20, name: "Gold Hoops", category: "Earrings", price: "PKR 55,000", img: "https://images.pexels.com/photos/8396187/pexels-photo-8396187.jpeg?auto=compress&cs=tinysrgb&w=800" }
        ];

        // --- 2. VIDEO MANAGER SYSTEM ---
        const VideoManager = {
            videoElement: document.getElementById('bg-video'),
            
            // Called immediately on load
            init: function() {
                // Ensure video is playing
                this.videoElement.play().then(() => {
                    // Fade video in smoothly
                    this.videoElement.style.opacity = '1';
                }).catch(e => {
                    console.log("Autoplay blocked or missing file. Using fallback background.");
                    // Fallback handled by CSS background-image on body
                });

                // --- SYSTEM 1: INTRO ANIMATION TRIGGER ---
                // We wait 0.5s for video to establish, then fade in the UI
                setTimeout(() => {
                    this.triggerIntroAnimation();
                }, 800);
            },

            // The "Intro Animation" of the website UI
            triggerIntroAnimation: function() {
                const tl = gsap.timeline();
                
                // 1. Reveal Navbar
                tl.to('#navbar', { opacity: 1, duration: 1.5, ease: "power2.out" })
                // 2. Reveal Hero Content (if on home)
                  .fromTo('#hero-content', { y: 50, opacity: 0 }, { y: 0, opacity: 1, duration: 1.5, ease: "power3.out" }, "-=1");
                
                // Note: The video continues playing behind this, fulfilling "System 2"
            },
            
            // Method to switch video source if you want a different loop later
            switchVideo: function(newSrc) {
                const v = this.videoElement;
                gsap.to(v, { opacity: 0, duration: 0.5, onComplete: () => {
                    v.src = newSrc;
                    v.play();
                    gsap.to(v, { opacity: 1, duration: 0.5 });
                }});
            }
        };

        // --- 3. ROUTER & PAGE RENDERING ---
        const app = document.getElementById('app');
        let cart = [];

        function router(view) {
            // Cinematic Fade Transition between pages
            gsap.to(app, { opacity: 0, y: -20, duration: 0.3, onComplete: () => {
                window.scrollTo(0,0);
                app.innerHTML = '';
                
                if (view === 'home') renderHome();
                else if (view === 'collections') renderCollections();
                else if (view === 'virtual') renderVirtual();
                else if (view === 'cart') renderCart();
                
                gsap.fromTo(app, { opacity: 0, y: 30 }, { opacity: 1, y: 0, duration: 0.5 });
            }});
        }

        function renderHome() {
            app.innerHTML = `
                <div id="hero-content" class="min-h-[70vh] flex flex-col items-center justify-center text-center opacity-0">
                    <div class="mb-6 relative">
                         <div class="absolute inset-0 bg-gold-400 blur-[40px] opacity-20 rounded-full"></div>
                         <h2 class="relative text-gold-400 tracking-[0.6em] uppercase text-[10px] md:text-xs font-bold mb-2">Est. 1990 â€¢ Gujrat</h2>
                    </div>
                    
                    <h1 class="text-5xl md:text-8xl font-serif font-bold text-transparent bg-clip-text bg-gradient-to-b from-white via-gold-100 to-gold-400 mb-8 drop-shadow-2xl">
                        MADNI
                        <span class="block text-xl md:text-3xl font-sans font-light tracking-[0.4em] text-white mt-4 uppercase">Jewellers</span>
                    </h1>
                    
                    <div class="flex flex-col md:flex-row gap-6">
                        <button onclick="router('collections')" class="group relative px-8 py-3 bg-transparent overflow-hidden border border-gold-400 text-gold-400 transition-all duration-300 hover:text-black hover:bg-gold-400">
                            <span class="relative z-10 text-xs font-bold uppercase tracking-widest">Explore Collection</span>
                        </button>
                        <button onclick="router('virtual')" class="px-8 py-3 text-white border border-white/20 hover:bg-white hover:text-black transition text-xs font-bold uppercase tracking-widest">
                            <i class="ph-bold ph-cube"></i> Virtual Vault
                        </button>
                    </div>

                    <!-- Trust Indicators -->
                    <div class="mt-20 grid grid-cols-3 gap-8 md:gap-20 text-center opacity-80">
                        <div>
                            <h3 class="text-gold-400 text-xl font-serif">24K</h3>
                            <p class="text-[9px] uppercase tracking-widest text-gray-400">Purity</p>
                        </div>
                        <div>
                            <h3 class="text-gold-400 text-xl font-serif">100%</h3>
                            <p class="text-[9px] uppercase tracking-widest text-gray-400">Certified</p>
                        </div>
                        <div>
                            <h3 class="text-gold-400 text-xl font-serif">30+</h3>
                            <p class="text-[9px] uppercase tracking-widest text-gray-400">Years</p>
                        </div>
                    </div>
                </div>
            `;
            // Note: Animation triggers via VideoManager on first load, or automatically here if returning
            if(document.getElementById('navbar').style.opacity == 1) {
                gsap.to('#hero-content', { opacity: 1, duration: 1 });
            }
        }

        function renderCollections() {
            const categories = ["All", ...new Set(products.map(p => p.category))];
            
            app.innerHTML = `
                <div class="pb-20">
                    <div class="flex flex-col md:flex-row justify-between items-end mb-8 border-b border-white/10 pb-4">
                        <h2 class="text-3xl font-serif text-gold-400">Masterpieces</h2>
                        <div class="flex flex-wrap gap-2 mt-4 md:mt-0">
                            ${categories.map(cat => `<button onclick="filter('${cat}')" class="px-4 py-1 border border-white/10 glass-card text-[10px] uppercase tracking-wider hover:border-gold-400 hover:text-gold-400 transition">${cat}</button>`).join('')}
                        </div>
                    </div>
                    <div id="grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        ${renderProductGrid(products)}
                    </div>
                </div>
            `;
            gsap.from('.product-card', { y: 30, opacity: 0, duration: 0.5, stagger: 0.05 });
        }

        function renderProductGrid(list) {
            return list.map(p => `
                <div class="product-card glass-card group overflow-hidden relative cursor-pointer">
                    <div class="h-72 w-full overflow-hidden relative">
                        <img src="${p.img}" class="w-full h-full object-cover transition duration-700 group-hover:scale-110 opacity-90 group-hover:opacity-100">
                        <div class="absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition duration-300 flex items-center justify-center">
                            <button onclick="addToCart(${p.id})" class="px-6 py-2 bg-gold-400 text-black text-[10px] font-bold uppercase tracking-widest hover:bg-white transition shadow-lg transform translate-y-4 group-hover:translate-y-0 duration-300">
                                Add to List
                            </button>
                        </div>
                    </div>
                    <div class="p-4 bg-gradient-to-b from-transparent to-black/80">
                        <h3 class="font-serif text-md text-white group-hover:text-gold-400 transition">${p.name}</h3>
                        <p class="text-[9px] text-gray-400 uppercase tracking-widest my-1">${p.category}</p>
                        <p class="text-gold-300 font-bold text-sm">${p.price}</p>
                    </div>
                </div>
            `).join('');
        }

        function filter(cat) {
            const filtered = cat === 'All' ? products : products.filter(p => p.category === cat);
            const grid = document.getElementById('grid');
            gsap.to(grid, { opacity: 0, duration: 0.2, onComplete: () => {
                grid.innerHTML = renderProductGrid(filtered);
                gsap.to(grid, { opacity: 1, duration: 0.4 });
            }});
        }

        function renderVirtual() {
            app.innerHTML = `
                <div class="h-[70vh] flex items-center justify-center">
                    <div class="glass-card p-10 max-w-xl text-center border border-gold-400/30">
                        <i class="ph-duotone ph-cube text-6xl text-gold-400 mb-6 animate-pulse"></i>
                        <h2 class="text-2xl font-serif mb-3 text-white">The Madni Virtual Vault</h2>
                        <p class="text-gray-400 text-sm mb-8 leading-relaxed">
                            Step into our digital showroom simulation. Walk through the gallery using your keyboard (WASD) and explore our exclusive collection in 3D.
                        </p>
                        <button onclick="startImmersiveMode()" class="px-8 py-3 bg-gold-400 text-black font-bold uppercase tracking-widest hover:bg-white transition shadow-[0_0_20px_rgba(212,175,55,0.3)]">
                            Launch Simulation
                        </button>
                    </div>
                </div>
            `;
        }

        function renderCart() {
            const msg = `Hello Madni Jewellers, I would like to book an appointment to view:%0A${cart.map(i => `- ${i.name} (${i.price})`).join('%0A')}`;
            
            app.innerHTML = `
                <div class="max-w-4xl mx-auto pb-20">
                    <h2 class="text-3xl font-serif text-gold-400 mb-8 border-b border-white/10 pb-4">Your Selection</h2>
                    ${cart.length === 0 ? 
                        `<div class="text-center py-12 text-gray-500">
                            <i class="ph ph-shopping-bag-open text-4xl mb-4"></i>
                            <p>No items selected.</p>
                            <button onclick="router('collections')" class="text-gold-400 underline mt-4">Browse Collection</button>
                        </div>` : 
                        `<div class="space-y-3 mb-8">
                            ${cart.map((item, idx) => `
                                <div class="flex justify-between items-center glass-card p-4 border-l-4 border-l-gold-400">
                                    <div class="flex items-center gap-4">
                                        <img src="${item.img}" class="w-12 h-12 object-cover rounded border border-white/10">
                                        <div>
                                            <h4 class="font-serif text-sm">${item.name}</h4>
                                            <p class="text-gold-400 text-xs">${item.price}</p>
                                        </div>
                                    </div>
                                    <button onclick="removeFromCart(${idx})" class="text-white/40 hover:text-red-500 transition"><i class="ph-bold ph-trash"></i></button>
                                </div>
                            `).join('')}
                        </div>
                        <div class="flex justify-end gap-4">
                            <button onclick="router('collections')" class="px-6 py-3 border border-white/10 hover:bg-white/5 text-xs uppercase font-bold">Add More</button>
                            <a href="https://wa.me/923006262886?text=${msg}" target="_blank" class="px-8 py-3 bg-rolexGreen text-white font-bold uppercase tracking-widest hover:bg-green-700 transition flex items-center gap-2 text-xs">
                                <i class="ph-bold ph-whatsapp-logo text-lg"></i> Book Appointment
                            </a>
                        </div>`
                    }
                </div>
            `;
        }

        // --- 4. INTERACTIONS ---
        function addToCart(id) {
            cart.push(products.find(p => p.id === id));
            document.getElementById('cart-count').innerText = cart.length;
            
            // Visual Feedback
            const btn = event.target;
            const originalText = btn.innerText;
            btn.innerText = "Added";
            btn.classList.add('bg-green-600', 'text-white');
            setTimeout(() => {
                btn.innerText = originalText;
                btn.classList.remove('bg-green-600', 'text-white');
            }, 1000);
        }

        function removeFromCart(idx) {
            cart.splice(idx, 1);
            document.getElementById('cart-count').innerText = cart.length;
            renderCart();
        }

        function toggleChat() {
            document.getElementById('chatbot').classList.toggle('active');
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const history = document.getElementById('chat-history');
            if(!input.value) return;
            
            history.innerHTML += `<div class="text-right mb-2"><span class="bg-gold-400 text-black px-3 py-2 rounded-lg inline-block shadow-lg">${input.value}</span></div>`;
            input.value = '';
            
            setTimeout(() => {
                history.innerHTML += `<div class="text-left mb-2 flex gap-2"><div class="w-6 h-6 rounded-full bg-gold-400 flex items-center justify-center text-black font-bold text-[10px]">M</div><span class="bg-white/10 text-gray-200 px-3 py-2 rounded-lg inline-block border border-white/5">Please contact 03006262886 for details.</span></div>`;
                history.scrollTop = history.scrollHeight;
            }, 1000);
        }

        // --- 5. IMMERSIVE MODE (3D) ---
        function startImmersiveMode() {
            // Hide standard UI
            document.getElementById('ui-container').style.display = 'none';
            document.getElementById('video-layer').style.display = 'none';
            
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);
            scene.fog = new THREE.Fog(0x050505, 0, 40);
            
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({antialias: true});
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
            
            // Floor
            const floor = new THREE.Mesh(new THREE.PlaneGeometry(200, 200), new THREE.MeshStandardMaterial({ color: 0x111111, roughness: 0.1, metalness: 0.5 }));
            floor.rotation.x = -Math.PI / 2;
            scene.add(floor);
            
            // Lights
            scene.add(new THREE.AmbientLight(0xffffff, 0.2));
            const pLight = new THREE.PointLight(0xD4AF37, 2, 50);
            pLight.position.set(0, 10, 0);
            scene.add(pLight);
            
            // Pillars / Art
            const boxGeo = new THREE.BoxGeometry(1, 4, 1);
            const boxMat = new THREE.MeshStandardMaterial({ color: 0xD4AF37, metalness: 0.8, roughness: 0.2 });
            for(let i=0; i<30; i++) {
                const mesh = new THREE.Mesh(boxGeo, boxMat);
                mesh.position.set((Math.random()-0.5)*50, 2, (Math.random()-0.5)*50);
                scene.add(mesh);
            }

            const controls = new THREE.PointerLockControls(camera, document.body);
            
            // Overlay Instructions
            const overlay = document.createElement('div');
            overlay.className = 'fixed inset-0 flex flex-col items-center justify-center bg-black/80 z-50 text-gold-400 cursor-pointer';
            overlay.innerHTML = '<h1 class="text-4xl font-serif mb-2">CLICK TO ENTER</h1><p class="text-sm">WASD to Move | ESC to Exit</p>';
            document.body.appendChild(overlay);
            
            overlay.addEventListener('click', () => controls.lock());
            controls.addEventListener('lock', () => overlay.style.display = 'none');
            controls.addEventListener('unlock', () => {
                 overlay.innerHTML = '<h1 class="text-4xl font-serif mb-2">PAUSED</h1><p class="text-sm">Click to Resume or <button id="exit-sim" class="underline text-white">Exit to Website</button></p>';
                 overlay.style.display = 'flex';
                 document.getElementById('exit-sim').addEventListener('click', () => location.reload());
            });

            // Movement
            let moveF=false, moveB=false, moveL=false, moveR=false;
            document.addEventListener('keydown', (e) => { if(e.code=='KeyW')moveF=true; if(e.code=='KeyS')moveB=true; if(e.code=='KeyA')moveL=true; if(e.code=='KeyD')moveR=true; });
            document.addEventListener('keyup', (e) => { if(e.code=='KeyW')moveF=false; if(e.code=='KeyS')moveB=false; if(e.code=='KeyA')moveL=false; if(e.code=='KeyD')moveR=false; });

            camera.position.y = 1.7;

            function animate() {
                requestAnimationFrame(animate);
                if(controls.isLocked) {
                    if(moveF) controls.moveForward(0.15);
                    if(moveB) controls.moveForward(-0.15);
                    if(moveL) controls.moveRight(-0.15);
                    if(moveR) controls.moveRight(0.15);
                }
                renderer.render(scene, camera);
            }
            animate();
        }

        // --- 6. PARTICLES BACKGROUND (Subtle) ---
        function initParticles() {
            const container = document.getElementById('particles-container');
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);
            
            const geometry = new THREE.BufferGeometry();
            const pos = new Float32Array(600 * 3);
            for(let i=0; i<1800; i++) pos[i] = (Math.random()-0.5)*15;
            geometry.setAttribute('position', new THREE.BufferAttribute(pos, 3));
            
            const material = new THREE.PointsMaterial({ size: 0.02, color: 0xD4AF37, transparent: true, opacity: 0.4 });
            const stars = new THREE.Points(geometry, material);
            scene.add(stars);
            camera.position.z = 2;
            
            function animate() {
                requestAnimationFrame(animate);
                stars.rotation.y += 0.0005;
                renderer.render(scene, camera);
            }
            animate();
            
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth/window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            VideoManager.init(); // Start video immediately
            initParticles();     // Start particles
            renderHome();        // Render HTML structure
        };

    </script>
</body>
</html>
